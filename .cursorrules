# Laravel Studio - Cursor Rules

You are working with **Laravel Studio**, a free Laravel Nova alternative for building admin panels.

## Package Info

- Namespace: `SavyApps\LaravelStudio`
- Package: `savyapps-com/laravel-studio`

## Key Patterns

### Backend (PHP/Laravel)

1. **Resources** extend `SavyApps\LaravelStudio\Resources\Resource`
2. **Business logic** goes in service classes (`app/Services/`)
3. **Use named routes**, never hardcode paths
4. **Validate** using `rules()` method in resources

### Frontend (Vue 3)

1. **API calls** go through services (`resources/js/services/`)
2. **State management** uses Pinia stores
3. **Reusable logic** in composables (`resources/js/composables/`)
4. **Never call API directly** from components

## Creating Resources

```bash
php artisan studio:make-resource ProductResource
```

```php
<?php
namespace App\Resources;

use SavyApps\LaravelStudio\Resources\Resource;
use SavyApps\LaravelStudio\Resources\Fields\{ID, Text, Number, Boolean, Section};
use SavyApps\LaravelStudio\Resources\Filters\{SelectFilter, BooleanFilter};
use SavyApps\LaravelStudio\Resources\Actions\BulkDeleteAction;

class ProductResource extends Resource
{
    public static string $model = \App\Models\Product::class;
    public static string $title = 'name';
    public static array $search = ['name', 'sku'];

    public function indexFields(): array
    {
        return [
            ID::make()->sortable(),
            Text::make('Name')->sortable()->searchable(),
            Number::make('Price')->sortable(),
            Boolean::make('Active')->toggleable(),
        ];
    }

    public function formFields(): array
    {
        return [
            Section::make('Details')->fields([
                Text::make('Name')->rules('required', 'max:255'),
                Number::make('Price')->rules('required', 'min:0'),
                Boolean::make('Active')->default(true),
            ]),
        ];
    }

    public function filters(): array
    {
        return [
            BooleanFilter::make('Active'),
        ];
    }

    public function actions(): array
    {
        return [
            BulkDeleteAction::make(),
        ];
    }
}
```

## Field Types (21)

**Basic:** ID, Text, Email, Password, Number, Boolean, Date, Textarea
**Advanced:** Select, JSON, Image, Media, IconPicker, TagInput, MultiSelectServer
**Relationships:** BelongsTo, BelongsToMany, HasMany
**Layout:** Group, Section

## Field Methods

```php
Field::make('Name')
    ->sortable()
    ->searchable()
    ->rules('required', 'max:255')
    ->default('value')
    ->placeholder('Enter name')
    ->help('Help text')
    ->cols(6)                    // Grid span 1-12
    ->showOnIndex()
    ->showOnCreate()
    ->showOnUpdate()
    ->dependsOn('other_field')
    ->showWhen('field', 'value')
    ->requiredWhen('field', 'value');
```

## Filters

```php
SelectFilter::make('Status')->options(StatusEnum::class);
BooleanFilter::make('Active');
DateRangeFilter::make('Created')->column('created_at');
BelongsToManyFilter::make('Tags')->relationship('tags');
```

## Actions

```php
// Built-in
BulkDeleteAction::make()->confirmable();
BulkUpdateAction::make()->fields(['status']);
ExportAction::make()->formats(['csv', 'xlsx']);

// Custom
php artisan studio:make-action ActivateAction
```

## Traits

- `Authorizable` - Add to resources for permissions
- `LogsActivity` - Add to models for audit trail
- `HasPermissions` - Add to User model
- `GloballySearchable` - Add to resources for search
- `ApiResponse` - Add to controllers

## Services

**Backend:** ResourceService, PanelService, AuthorizationService, ActivityService, GlobalSearchService, CardService

**Frontend:**
```javascript
import { resourceService, searchService, permissionService } from '@/services'

await resourceService.getIndex('users', { page: 1 })
await resourceService.create('users', data)
await searchService.globalSearch('query')
```

## Composables

```javascript
import { useToast, useDialog, usePermissions } from '@/composables'

const { success, error } = useToast()
const { confirm } = useDialog()
const { can } = usePermissions()
```

## Artisan Commands

```bash
studio:make-resource Name    # Create resource
studio:make-action Name      # Create action
studio:make-filter Name      # Create filter
studio:make-panel            # Create panel (interactive)
studio:sync-permissions      # Sync permissions
studio:doctor                # Run diagnostics
```

## API Endpoints

```
GET/POST   /api/studio/panels/{panel}/resources/{resource}
GET/PUT/DELETE /api/studio/panels/{panel}/resources/{resource}/{id}
POST       /api/studio/panels/{panel}/resources/{resource}/bulk/delete
GET        /api/search
```

## Config

Register resources in `config/studio.php`:
```php
'resources' => [
    'products' => \App\Resources\ProductResource::class,
],
```

## Anti-Patterns

- Don't put business logic in resources (use services)
- Don't call API directly from Vue components (use services)
- Don't hardcode routes (use named routes)
- Don't skip validation
- Don't duplicate components (check existing ones)
